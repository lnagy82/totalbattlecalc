"use strict";(self.webpackChunktotalbattlecalc=self.webpackChunktotalbattlecalc||[]).push([[768],{768:(F,p,a)=>{a.r(p),a.d(p,{TroopCalculatorModule:()=>x});var u=a(6274),h=a(805),d=a(2889),t=a(2741),g=a(6995);class U{constructor(r,e){this.leadership=r,this.battleUnits=e}}let m=(()=>{class n{constructor(){}incrementTroops(e){e[0].number=e[0].number+1}decrementTroops(e,o){for(let i=0;i<e.length;i++)if(e[i]!==o[i]){o[i].number=o[i].number-1;break}}eqTroops(e,o){for(let i=0;i<e.length;i++)if(e[i]!==o[i])return!1;return!0}sumLeadership(e){let o=0;return e.forEach(i=>{o+=i.unit.leadership*i.number}),o}sumCost(e){let o=0;return e.forEach(i=>{o+=i.getAllCost()}),o}sumStrength(e){let o=0;return e.forEach(i=>{o+=this.getAllStrength(i)}),o}getAllStrength(e){return e.unit.strength*e.number*((e.bStrength+100)/100)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),_=(()=>{class n extends m{constructor(){super()}optimizeTroopsHealth(e,o,i){do{this.incrementTroops(e),e.sort((l,c)=>this.getAllHealth(l)-this.getAllHealth(c))}while(i>=this.sumLeadership(e));do{this.decrementTroops(e,o),e.sort((l,c)=>this.getAllHealth(l)-this.getAllHealth(c))}while(!this.eqTroops(e,o))}getAllHealth(e){return e.unit.health*e.number*((e.bHealth+100)/100)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),T=(()=>{class n{constructor(){}initializePreferredUnits(e){return[...e].sort((i,l)=>l.unit.strength-i.unit.strength)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),f=(()=>{class n{constructor(e,o){this.healthOptimizerService=e,this.preferredUnitFactoryService=o}getTroopsCalculation(e,o){const i=this.preferredUnitFactoryService.initializePreferredUnits(e);return this.healthOptimizerService.optimizeTroopsHealth(e,i,o),new U(this.healthOptimizerService.sumLeadership(e),e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_),t.LFG(T))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var b=a(5519),Z=a(4243),s=a(3324),v=a(4477);function C(n,r){if(1&n&&(t.TgZ(0,"option",13),t._uU(1),t.qZA()),2&n){const e=r.$implicit;t.Q6J("ngValue",e),t.xp6(1),t.hij("\n      ",e.name,"\n    ")}}function A(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"tr",20),t._uU(1,"\n        "),t.TgZ(2,"th"),t._UZ(3,"fa-icon",21),t.qZA(),t._uU(4,"\n        "),t.TgZ(5,"td"),t._uU(6),t.qZA(),t._uU(7,"\n        "),t.TgZ(8,"td"),t._uU(9),t.qZA(),t._uU(10,"\n        "),t._uU(11,"\n        "),t.TgZ(12,"td"),t._uU(13),t.ALo(14,"number"),t.qZA(),t._uU(15,"\n        "),t.TgZ(16,"td",22),t._uU(17,"\n          "),t.TgZ(18,"div",9),t._uU(19,"\n            "),t.TgZ(20,"button",23),t.NdJ("click",function(){const l=t.CHM(e).$implicit;return t.oxw(2).gotoHome(l)}),t._uU(21,"\n              "),t._UZ(22,"fa-icon",24),t._uU(23,"\n              "),t.TgZ(24,"span",25),t._uU(25,"Remove"),t.qZA(),t._uU(26,"\n            "),t.qZA(),t._uU(27,"\n          "),t.qZA(),t._uU(28,"\n        "),t.qZA(),t._uU(29,"\n      "),t.qZA()}if(2&n){const e=r.$implicit,o=t.oxw(2);t.xp6(6),t.Oqu(e.unit.name),t.xp6(3),t.Oqu(e.number),t.xp6(4),t.Oqu(t.xi3(14,3,o.getAllHealth(e),"1.0-0"))}}function y(n,r){if(1&n&&(t.TgZ(0,"div",14),t._uU(1,"\n  "),t.TgZ(2,"table",15),t._uU(3,"\n    "),t.TgZ(4,"thead"),t._uU(5,"\n      "),t.TgZ(6,"tr"),t._uU(7,"\n        "),t._UZ(8,"th"),t._uU(9,"\n        "),t.TgZ(10,"th"),t._uU(11,"\n          "),t.TgZ(12,"span",16),t._uU(13,"Name"),t.qZA(),t._uU(14,"\n        "),t.qZA(),t._uU(15,"\n        "),t.TgZ(16,"th"),t._uU(17,"\n          "),t.TgZ(18,"span",17),t._uU(19,"Number"),t.qZA(),t._uU(20,"\n        "),t.qZA(),t._uU(21,"\n        "),t._uU(22,"\n        "),t.TgZ(23,"th"),t._uU(24,"\n          "),t.TgZ(25,"span",18),t._uU(26,"Health"),t.qZA(),t._uU(27,"\n        "),t.qZA(),t._uU(28,"\n        "),t._UZ(29,"th"),t._uU(30,"\n      "),t.qZA(),t._uU(31,"\n    "),t.qZA(),t._uU(32,"\n    "),t.TgZ(33,"tbody"),t._uU(34,"\n      "),t.YNc(35,A,30,6,"tr",19),t._uU(36,"\n    "),t.qZA(),t._uU(37,"\n  "),t.qZA(),t._uU(38,"\n"),t.qZA()),2&n){const e=t.oxw();t.xp6(35),t.Q6J("ngForOf",e.battleUnits)("ngForTrackBy",e.trackId)}}const S=[{path:"",component:(()=>{class n{constructor(e,o,i){this.unitService=e,this.troopCalculatorService=o,this.localStorageService=i,this.battleUnits=[],this.isLoading=!1,this.maxLeadership=28e3,this.bHealth=0}ngOnInit(){this.unitService.query().subscribe(e=>{var o,i;this.isLoading=!1,this.battleUnits=null!==(o=this.localStorageService.retrieve("battleUnits"))&&void 0!==o?o:[],this.possibleUnits=this.localStorageService.retrieve("possibleUnits"),(null==this.possibleUnits||0===this.possibleUnits.length)&&(this.possibleUnits=null!==(i=e.body)&&void 0!==i?i:[],this.sortByName(this.possibleUnits))},()=>{this.isLoading=!1})}trackId(e,o){return o.id}gotoBattle(){if(this.selectedUnit){this.battleUnits.push(new d.Z(1,0,564,this.bHealth,this.selectedUnit));const e=this.possibleUnits.indexOf(this.selectedUnit);this.possibleUnits.splice(e,1),this.selectedUnit=void 0,this.saveUnits()}console.log(this.selectedUnit)}gotoHome(e){const o=this.battleUnits.indexOf(e);this.battleUnits.splice(o,1),this.possibleUnits.push(e.unit),this.sortByName(this.possibleUnits),this.saveUnits()}calculate(){this.battleUnits.forEach(o=>{o.number=0});const e=this.troopCalculatorService.getTroopsCalculation(this.battleUnits,this.maxLeadership);this.battleUnits=e.battleUnits,this.leadership=e.leadership,this.saveUnits()}getAllHealth(e){return e.unit.health*e.number*(e.bHealth+100)/100}saveUnits(){this.localStorageService.store("possibleUnits",this.possibleUnits),this.localStorageService.store("battleUnits",this.battleUnits)}sortByName(e){e.sort(function(o,i){return o.name<i.name?-1:o.name>i.name?1:0})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(g._),t.Y36(f),t.Y36(b.n2))},n.\u0275cmp=t.Xpm({type:n,selectors:[["jhi-troop-calculator"]],decls:55,vars:7,consts:[["type","button","data-toggle","collapse","data-target","#collapseExample","aria-expanded","false","aria-controls","collapseExample",1,"btn","btn-primary"],["type","button",1,"btn","btn-primary",3,"click"],["id","collapseExample",1,"collapse"],[1,"form-group"],["jhiTranslate","totalbattlecalcApp.unit.leadership","for","field_leadership",1,"form-control-label"],["type","text","name","leadership","id","field_leadership","data-cy","leadership",1,"form-control",3,"ngModel","ngModelChange"],["jhiTranslate","totalbattlecalcApp.unit.home.title","for","field_features"],["id","field_features",1,"form-control",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf","ngForTrackBy"],[1,"btn-group"],["type","number","name","bHealth","id","field_bHealth",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","leadership","id","field_leadership","data-cy","leadership","disabled","",1,"form-control",3,"ngModel","ngModelChange"],["class","table-responsive","id","entities",4,"ngIf"],[3,"ngValue"],["id","entities",1,"table-responsive"],["aria-describedby","page-heading",1,"table","table-striped"],["jhiTranslate","totalbattlecalcApp.unit.name"],["jhiTranslate","totalbattlecalcApp.battleUnit.number"],["jhiTranslate","totalbattlecalcApp.unit.health"],["data-cy","entityTable",4,"ngFor","ngForOf","ngForTrackBy"],["data-cy","entityTable"],["icon","users"],[1,"text-right"],["data-cy","entityDetailsButton",1,"btn","btn-danger","btn-sm",3,"click"],["icon","trash-alt"],["jhiTranslate","entity.action.remove",1,"d-none","d-md-inline"]],template:function(e,o){1&e&&(t.TgZ(0,"p"),t._uU(1,"\n  "),t.TgZ(2,"button",0),t._uU(3,"\n    Setup\n  "),t.qZA(),t._uU(4,"\n  "),t.TgZ(5,"button",1),t.NdJ("click",function(){return o.calculate()}),t._uU(6,"Calculate"),t.qZA(),t._uU(7,"\n"),t.qZA(),t._uU(8,"\n"),t.TgZ(9,"div",2),t._uU(10,"\n  "),t.TgZ(11,"div",3),t._uU(12,"\n    "),t.TgZ(13,"label",4),t._uU(14,"Maximum Leadership"),t.qZA(),t._uU(15,"\n    "),t.TgZ(16,"input",5),t.NdJ("ngModelChange",function(l){return o.maxLeadership=l}),t.qZA(),t._uU(17,"\n  "),t.qZA(),t._uU(18,"\n"),t.qZA(),t._uU(19,"\n"),t.TgZ(20,"div",3),t._uU(21,"\n  "),t.TgZ(22,"label",6),t._uU(23,"Unit"),t.qZA(),t._uU(24,"\n  "),t.TgZ(25,"select",7),t.NdJ("ngModelChange",function(l){return o.selectedUnit=l}),t._uU(26,"\n    "),t.YNc(27,C,2,2,"option",8),t._uU(28,"\n  "),t.qZA(),t._uU(29,"\n"),t.qZA(),t._uU(30,"\n"),t.TgZ(31,"div",9),t._uU(32,"\n  "),t.TgZ(33,"div",3),t._uU(34,"\n    "),t.TgZ(35,"button",1),t.NdJ("click",function(){return o.gotoBattle()}),t._uU(36,"Add with health bonus"),t.qZA(),t._uU(37,"\n  "),t.qZA(),t._uU(38,"\n  "),t.TgZ(39,"div",3),t._uU(40,"\n    "),t.TgZ(41,"input",10),t.NdJ("ngModelChange",function(l){return o.bHealth=l}),t.qZA(),t._uU(42,"\n  "),t.qZA(),t._uU(43,"\n"),t.qZA(),t._uU(44,"\n"),t.TgZ(45,"div",3),t._uU(46,"\n  "),t.TgZ(47,"label",4),t._uU(48,"Maximum Leadership"),t.qZA(),t._uU(49,"\n  "),t.TgZ(50,"input",11),t.NdJ("ngModelChange",function(l){return o.leadership=l}),t.qZA(),t._uU(51,"\n"),t.qZA(),t._uU(52,"\n"),t.YNc(53,y,39,2,"div",12),t._uU(54,"\n")),2&e&&(t.xp6(16),t.Q6J("ngModel",o.maxLeadership),t.xp6(9),t.Q6J("ngModel",o.selectedUnit),t.xp6(2),t.Q6J("ngForOf",o.possibleUnits)("ngForTrackBy",o.trackId),t.xp6(14),t.Q6J("ngModel",o.bHealth),t.xp6(9),t.Q6J("ngModel",o.leadership),t.xp6(3),t.Q6J("ngIf",o.battleUnits&&o.battleUnits.length>0))},directives:[Z.P,s.Fj,s.JJ,s.On,s.EJ,u.sg,s.wV,u.O5,s.YN,s.Kr,v.BN],pipes:[u.JJ],styles:["button[_ngcontent-%COMP%]{width:200px}select[_ngcontent-%COMP%]{width:400px}input[_ngcontent-%COMP%]{width:200px}"]}),n})()}];let q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[h.Bz.forChild(S)],h.Bz]}),n})();var M=a(1382);let x=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[M.m,q,u.ez]]}),n})()}}]);